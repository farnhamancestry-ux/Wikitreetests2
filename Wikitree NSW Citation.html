<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NSW WikiTree Citation Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
    </style>
</head>
<body class="antialiased text-gray-800 p-4">
    <div class="max-w-4xl mx-auto my-8 bg-white p-8 rounded-2xl shadow-xl border border-gray-200">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-extrabold text-gray-900 mb-2">NSW WikiTree Citation Generator</h1>
            <p class="text-gray-600">Generate correctly formatted citations for New South Wales Birth, Marriage, and Death records for use on WikiTree.</p>
        </header>

        <!-- Main Form Container -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

            <!-- Input Fields Column -->
            <div class="bg-gray-50 p-6 rounded-xl border border-gray-200">
                <h2 class="text-2xl font-bold mb-4 text-gray-900">Record Details</h2>
                <div class="space-y-4">
                    <!-- Event Type Dropdown -->
                    <div>
                        <label for="eventType" class="block text-sm font-medium text-gray-700 mb-1">Select Event Type</label>
                        <select id="eventType" onchange="updateFields(); generateCitation();" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200">
                            <option value="birth"><b>Birth Registration</b></option>
                            <option value="marriage"><b>Marriage Registration</b></option>
                            <option value="death"><b>Death Registration</b></option>
                        </select>
                    </div>

                    <!-- Person/Couple Name -->
                    <div>
                        <label for="name" class="block text-sm font-medium text-gray-700 mb-1">Person's Name / Couple's Names</label>
                        <input type="text" id="name" oninput="generateCitation()" placeholder="e.g., Varney Parkes" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>

                    <!-- Registration Number -->
                    <div>
                        <label for="regNum" class="block text-sm font-medium text-gray-700 mb-1">Registration Number</label>
                        <input type="text" id="regNum" oninput="generateCitation()" placeholder="e.g., 12295/1859" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>

                    <!-- District -->
                    <div>
                        <label for="district" class="block text-sm font-medium text-gray-700 mb-1">District</label>
                        <input type="text" id="district" oninput="generateCitation()" placeholder="e.g., Ryde" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>

                    <!-- Father's Name (Visible for Birth/Death) -->
                    <div id="fatherField">
                        <label for="father" class="block text-sm font-medium text-gray-700 mb-1">Father's Name</label>
                        <input type="text" id="father" oninput="generateCitation()" placeholder="e.g., James" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>

                    <!-- Mother's Name (Visible for Birth/Death) -->
                    <div id="motherField">
                        <label for="mother" class="block text-sm font-medium text-gray-700 mb-1">Mother's Name</label>
                        <input type="text" id="mother" oninput="generateCitation()" placeholder="e.g., Mary" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>

                    <!-- Age (Visible for Death only) -->
                    <div id="ageField" class="hidden">
                        <label for="age" class="block text-sm font-medium text-gray-700 mb-1">Age</label>
                        <input type="text" id="age" oninput="generateCitation()" placeholder="e.g., 64" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>

                    <!-- Accessed Date -->
                    <div>
                        <label for="accessDate" class="block text-sm font-medium text-gray-700 mb-1">Accessed Date</label>
                        <input type="text" id="accessDate" oninput="generateCitation()" placeholder="e.g., 25 Apr 2021" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>
            </div>

            <!-- Generated Citation Column -->
            <div class="bg-gray-50 p-6 rounded-xl border border-gray-200 flex flex-col">
                <h2 class="text-2xl font-bold mb-4 text-gray-900">Generated Citation</h2>
                <div class="flex-grow bg-white p-4 rounded-lg border border-gray-300 mb-4 overflow-auto">
                    <pre id="citationBox" class="whitespace-pre-wrap font-mono text-sm text-gray-700"></pre>
                </div>
                <button id="copyBtn" onclick="copyToClipboard()" class="w-full bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                    Copy to Clipboard
                </button>
            </div>
        </div>
    </div>

    <script>
        // Get today's date in a friendly format (e.g., "25 Apr 2021")
        const today = new Date();
        const options = { day: 'numeric', month: 'short', year: 'numeric' };
        document.getElementById('accessDate').value = today.toLocaleDateString('en-GB', options);

        // Function to show/hide fields based on event type
        function updateFields() {
            const eventType = document.getElementById('eventType').value;
            document.getElementById('fatherField').classList.toggle('hidden', eventType === 'marriage');
            document.getElementById('motherField').classList.toggle('hidden', eventType === 'marriage');
            document.getElementById('ageField').classList.toggle('hidden', eventType !== 'death');
        }

        // Function to generate the citation string
        function generateCitation() {
            const eventType = document.getElementById('eventType').value;
            const name = document.getElementById('name').value.trim();
            const regNum = document.getElementById('regNum').value.trim();
            const district = document.getElementById('district').value.trim();
            const accessDate = document.getElementById('accessDate').value.trim();
            const father = document.getElementById('father').value.trim();
            const mother = document.getElementById('mother').value.trim();
            const age = document.getElementById('age').value.trim();

            let citationPrefix = '';
            let citationBody = '';
            let searchPageUrl = '';
            
            // Construct citation prefix and body based on event type
            switch (eventType) {
                case 'birth':
                    citationPrefix = 'Birth Registration';
                    searchPageUrl = '[https://familyhistory.bdm.nsw.gov.au/lifelink/familyhistory/search/births Births search page]';
                    citationBody = `:NSW Government. Registry of Births, Deaths and Marriages. ${name}, Birth. Registration number: ${regNum}, District: ${district}. Father: ${father}. Mother: ${mother}. Accessed ${accessDate}. ${searchPageUrl}`;
                    break;
                case 'marriage':
                    citationPrefix = 'Marriage Registration';
                    searchPageUrl = '[https://familyhistory.bdm.nsw.gov.au/lifelink/familyhistory/search/marriages Marriages search page]';
                    citationBody = `: NSW Government. Registry of Births, Deaths and Marriages. ${name}, Marriage. Registration number: ${regNum}, District: ${district}. Accessed ${accessDate}. ${searchPageUrl}`;
                    break;
                case 'death':
                    citationPrefix = 'Death Registration';
                    searchPageUrl = '[https://familyhistory.bdm.nsw.gov.au/lifelink/familyhistory/search/deaths Deaths search page]';
                    citationBody = `:NSW Government. Registry of Births, Deaths and Marriages. ${name}, Death. Registration number: ${regNum}, District: ${district}. Father: ${father}. Mother: ${mother}. Age: ${age}. Accessed ${accessDate}. ${searchPageUrl}`;
                    break;
            }

            // Combine the parts and wrap in <ref> tags
            const finalCitation = `<ref>'''${citationPrefix}'''${citationBody}</ref>`;

            // Update the display box
            document.getElementById('citationBox').textContent = finalCitation;
        }

        // Function to copy the citation to the clipboard
        function copyToClipboard() {
            const citationText = document.getElementById('citationBox').textContent;
            
            // A simple message box to notify the user
            const messageBox = document.createElement('div');
            messageBox.textContent = 'Copied to clipboard!';
            messageBox.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                background-color: #10b981;
                color: white;
                padding: 12px 24px;
                border-radius: 8px;
                font-weight: 600;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                opacity: 0;
                transition: opacity 0.3s ease-in-out;
            `;
            document.body.appendChild(messageBox);
            
            // Copy the text
            if (document.execCommand('copy')) {
                messageBox.style.opacity = 1;
                setTimeout(() => {
                    messageBox.style.opacity = 0;
                    setTimeout(() => messageBox.remove(), 300);
                }, 2000);
            } else {
                messageBox.textContent = 'Copy failed. Please try manually.';
                messageBox.style.backgroundColor = '#ef4444';
                messageBox.style.opacity = 1;
                setTimeout(() => {
                    messageBox.style.opacity = 0;
                    setTimeout(() => messageBox.remove(), 300);
                }, 2000);
            }
        }
        
        // Initial setup on page load
        window.onload = function() {
            updateFields();
            generateCitation();
        };
    </script>
</body>
</html>
